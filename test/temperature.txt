/* 
	Temperature test.
	TODO: need OOMMF comparison
*/

	setgridsize(32, 32, 1)
	setcellsize(4e-9, 4e-9, 4e-9)

	dot := circle(16*4e-9)
	setgeom(dot)
	defregion(1, dot)
	
	Msat = 800e3
	Aex = 13e-12
	m  = uniform(1, 1, 0)

	Msat.setregion(0, 0)

	alpha = 3
	run(.1e-9) 

	setsolver(1)
	fixdt = 1e-14
	thermSeed(1)
	Temp = 400
	thermSeed(0)

	alpha = 0.02

	tableadd(E_therm)
	save(B_therm)

	steps(3000)

	expect("mx", m.comp(0).average(), 0.7143311133751502, 1e-5)
