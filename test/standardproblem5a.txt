Nx := 64
Ny := 32
Nz := 1 // TODO: test for 2 as well!

sX := 160e-9
sY := 80e-9
sZ := 5e-9
 
setgridsize(Nx, Ny, Nz)
setcellsize(sX/Nx, sY/Ny, sZ/Nz)

Msat  = 800e3
Aex   = 13e-12
alpha = 1

maxdt    = 1e-12

// Set a initial magnetisation to C-state
m = uniform(1, 1, 0.001)

runwhile(maxtorque > 1e-5)
run(1e-9)

alpha        = 0.01
lambda       = 1
Pol          = 0.5669
epsilonprime = 0

pdeg := 1    
prad := pdeg * pi / 180.0
px := cos(prad)
py := sin(prad)
fixedlayer = vector(px, py, 0)

Jtot := -0.008  // total current in amps
carea := sX * sY
jc := Jtot / carea  
print("Current density is: " ,  jc)
 
J = vector(0, 0, jc)

autosave(m, 1e-12)
tableautosave(1e-12)

run(5e-9)
