/*
	Micromagnetic standard problem 4 (a) according to
	http://www.ctcms.nist.gov/~rdm/mumag.org.html
*/

// geometry
	setgridsize(128, 32, 1)
	setcellsize(500e-9/128, 125e-9/32, 3e-9)

// material
	Msat = 800e3
	Aex = 13e-12
	m  = uniform(1, .1, 0)

	defregion(1, Yrange(0, inf))
	defregion(2, Yrange(-inf, 0))
	ScaleExchReg(1, 2, 1.0)   // make sure scale by one works

// relax
	alpha = 3
	save(B_exch)
	save(m)
	run(10e-9) 
	expectv("m", m.average(), vector(0.966962456703186, 0.1252903491258621, -1.4529632608173415e-08), 1e-6)

// reversal
	alpha = 0.02
	B_ext = vector(-24.6E-3, 4.3E-3, 0)
	run(1e-9)
	expectv("m", m.average(), vector( -0.9845125675201416,  0.12704907357692719,  0.04322132468223572), 1e-6)

